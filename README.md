# YOLO-SLS and Spatiotemporal Correlation Network

This repository implements **YOLO-SLS**, a project that uses an IOU-based tracking system to extract key information from four 3-minute videos of different concentrations. The tracking system generates four Excel spreadsheets containing tracking data, which are processed by a spatiotemporal correlation network with Graph Attention Network with Bidirectional Gated Recurrent Unit (GAT-BiGRU) using a selection mechanism described in our article to produce a final classification output. 

## Overview

1. **YOLO-SLS**: Processes four input videos to extract object tracking data (e.g., fish trajectories) using an IOU-based tracking system implemented in `track.py`.
2. **IOU-Based Tracking System**: Tracks objects in the provided videos, outputting four Excel files with frame ID, track ID, and center coordinates.
3. **Spatiotemporal Correlation Network**: Takes the Excel files as input, applies a selection mechanism (as described in our article), and performs classification using a model combining YOLOv8, SLS, and GAT-BiGRU.
4. **Provided Excel**: Four 3-minute Excel are included in the `YOLOv8-SLS and GAT-BiGRU\GAT_BiGRU\data` directory for users to GAT_BiGRU

# Installation

```bash
git clone https://github.com/your-username/YOLOv8-SLS-and-GAT-BiGRU.git
cd YOLOv8-SLS-and-GAT-BiGRU
pip install -r requirements.txt
python setup.py install
```

# YOLO-SLS Requirements

```text
absl-py==1.4.0
beautifulsoup4==4.11.2
cryptography==3.4.7
efficientnet-pytorch==0.7.1
einops==0.8.0
huggingface-hub==0.26.2
jupyterlab==3.6.1
matplotlib==3.7.1
mmcv==2.2.0
mmdet==3.0.0
mmengine==0.10.5
numpy==1.24.2
opencv-python==4.10.0.84
pandas==2.0.3
Pillow==9.4.0
protobuf==4.22.1
pycocotools==2.0.7
pyOpenSSL==20.0.1
PyWavelets==1.4.1
PyYAML==6.0
requests==2.28.2
scipy==1.10.1
seaborn==0.13.2
tensorboard==2.12.0
torch==2.0.0+cu118
torchvision==0.15.1+cu118
tqdm==4.61.2
```

# Running the IOU Tracker

To run the IOU-based tracking system on the provided videos:

```bash
cd YOLOv8-SLS-and-GAT-BiGRU
python track.py
```

## IOU Tracker Requirements

```text
ultralytics==8.3.0
opencv-python==4.10.0
```

- **Input**: 
  ```python
  self.data = "path/to/your/video.mp4"
  ```
- **Output**:
  - Four Excel files (`<video_path>tracking_data.csv`) stored in `GAT_BiGRU/data`, containing frame ID, track ID, and center coordinates (x, y) for each video.
  - A video (`test_out-p2.mp4`) with tracked objects and their IDs.
  - Plots showing smoothed IOU values over time and IOU distribution.

# Running the Spatiotemporal Correlation Network

To train the spatiotemporal correlation network and perform classification:

```bash
cd YOLOv8-SLS-and-GAT-BiGRU
cd GAT_BiGRU/GAT-BiGRU
python train.py
```

## GAT-BiGRU Requirements

```text
tensorflow==2.15.0
pytorch==2.3.1
pandas==2.2.3
numpy==1.26.4
scikit-learn==1.5.2
matplotlib==3.9.2
scipy==1.13.1
```

- **Input**: The four Excel files generated by `track.py` in `GAT_BiGRU/data` are processed using the selection mechanism described in our article.
- **Output**: Classification results based on the spatiotemporal analysis of the tracking data.

# Data

The Excel files generated from the four 3-minute videos of different concentrations are placed in the `GAT_BiGRU/data` directory.

```bash
cd YOLOv8-SLS-and-GAT-BiGRU
cd GAT_BiGRU
cd data
```

To use custom Excel files, update the path in `GAT_BiGRU/pygcn/train.py`.

# Citation

```bibtex
@inproceedings{
  title={YOLO-SLS},
  author={Shi, Hongtao and Wang, Jing},
  year={2025}
}
@inproceedings{
  title={IOU-Based Tracking System},
  author={Shi, Hongtao and Yan, Fuxin},
  year={2025}
}
@inproceedings{
  title={Spatiotemporal Correlation Network},
  author={Shi, Hongtao and Yang, Fengdong},
  year={2025}
}
```

# Notes

- **Line Endings**: To handle LF/CRLF warnings, use the included `.gitattributes`:
  ```text
  *.py text eol=lf
  *.md text eol=lf
  *.xml text eol=lf
  LICENCE text eol=lf
  requirements.txt text eol=lf
  *.png binary
  *.jpg binary
  *.model binary
  *.mp4 binary
  *.csv text eol=lf
  ```
  Normalize files:
  ```bash
  git add --renormalize .
  git commit -m "Normalize line endings"
  ```

- **Ignoring IDE Files**: `.idea/` is excluded in `.gitignore`:
  ```text
  .idea/
  ```

- **YOLO Model**: Update the YOLO model weights path in `track.py` to match your setup.
- **License**: license='QingDao Agriculture University',
